# .github/workflows/deploy.yml
name: ğŸš€ Complete CI/CD Pipeline - DH52200893

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  validate:
    runs-on: ubuntu-latest
    name: âœ… Validate Assignment
    
    steps:
    - name: ğŸ“¥ Checkout code
      uses: actions/checkout@v3
    
    - name: ğŸ” Kiá»ƒm tra yÃªu cáº§u PTPMNM
      run: |
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
        echo "â•‘     BÃ€I Táº¬P PTPMNM - VALIDATION DH52200893   â•‘"
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        
        # Báº¯t buá»™c: MSSV
        echo "1. ğŸ” Kiá»ƒm tra MSSV DH52200893..."
        if grep -q "DH52200893" index.html; then
          echo "   â””â”€ âœ… PASS: MSSV cÃ³ trong code"
        else
          echo "   â””â”€ âŒ FAIL: Thiáº¿u MSSV"
          echo "::error file=index.html::MSSV DH52200893 khÃ´ng tÃ¬m tháº¥y"
          exit 1
        fi
        
        # Quan trá»ng: Lá»‹ch thi
        echo "2. ğŸ“… Kiá»ƒm tra lá»‹ch thi..."
        if grep -qi "thá»© 5\|thu 5" index.html; then
          echo "   â””â”€ âœ… PASS: CÃ³ thÃ´ng tin lá»‹ch thi"
        else
          echo "   â””â”€ âš ï¸ WARNING: KhÃ´ng tÃ¬m tháº¥y thÃ´ng tin lá»‹ch thi"
        fi
        
        # Báº¯t buá»™c: CÃ³ workflow
        echo "3. âš™ï¸ Kiá»ƒm tra file workflow..."
        if [ -f ".github/workflows/deploy.yml" ]; then
          echo "   â””â”€ âœ… PASS: CÃ³ file CI/CD workflow"
        else
          echo "   â””â”€ âŒ FAIL: KhÃ´ng cÃ³ file workflow"
          exit 1
        fi
        
        echo ""
        echo "âœ… Táº¤T Cáº¢ TIÃŠU CHÃ CHÃNH ÄÃƒ Äáº T!"

  deploy:
    runs-on: ubuntu-latest
    name: ğŸš€ Auto-Deploy to Vercel
    needs: validate
    environment: Production
    
    steps:
    - name: ğŸ“¥ Checkout code
      uses: actions/checkout@v3
    
    - name: ğŸš€ Deploy to Vercel
      id: vercel-deploy
      uses: amondnet/vercel-action@v20
      with:
        vercel-token: ${{ secrets.VERCEL_TOKEN }}
        vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
        vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
        vercel-args: '--prod --confirm'
    
    - name: ğŸ‰ Hiá»ƒn thá»‹ káº¿t quáº£ thÃ nh cÃ´ng
      run: |
        echo ""
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
        echo "â•‘          ğŸŠ DEPLOYMENT SUCCESSFUL!          â•‘"
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo ""
        echo "ğŸ“‹ THÃ”NG TIN BÃ€I Táº¬P:"
        echo "   ğŸ‘¨â€ğŸ“ MSSV: DH52200893"
        echo "   ğŸ“… Lá»‹ch thi: Thá»© 5 - Ca 4"
        echo "   âš™ï¸ CÃ´ng nghá»‡: GitHub Actions CI/CD"
        echo "   â˜ï¸ Platform: Vercel"
        echo ""
        echo "ğŸŒ THÃ”NG TIN DEPLOY:"
        echo "   ğŸ”— Production URL: https://thuchanh.vercel.app"
        echo "   ğŸ• Thá»i gian: $(date '+%Y-%m-%d %H:%M:%S')"
        echo "   ğŸ“ Commit: ${{ github.sha }}"
        echo ""
        echo "âœ… BÃ€I Táº¬P PTPMNM ÄÃƒ HOÃ€N THÃ€NH 100%"
        echo ""
        echo "ğŸ“Œ Báº±ng chá»©ng hoÃ n thÃ nh:"
        echo "- âœ… ÄÃ£ cÃ³ code vá»›i MSSV"
        echo "- âœ… ÄÃ£ cÃ³ GitHub Actions workflow"
        echo "- âœ… ÄÃ£ cáº¥u hÃ¬nh auto-deploy"
        echo "- âœ… ÄÃ£ deploy thÃ nh cÃ´ng lÃªn Vercel"
        echo "- âœ… Website Ä‘ang cháº¡y live"